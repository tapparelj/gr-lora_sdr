# auto-generated by grc.converter

id: lora_sdr_frame_sync
label: Frame sync
category: "[LoRa]/Rx"
flags: [python, cpp]

parameters:
  - id: samp_rate
    label: Samp_rate
    dtype: float
  - id: bandwidth
    label: Bandwidth
    dtype: int
  - id: sf
    label: Sf
    dtype: int
  - id: impl_head
    label: Impl_head
    dtype: bool
  - id: sync_words
    label: Sync words
    dtype: int_vector
    default: [8, 16]

inputs:
  - domain: stream
    dtype: complex
  - domain: message
    id: frame_info

outputs:
  - domain: stream
    dtype: complex
    vlen: ${ 2**sf }
  - domain: message
    id: new_frame
    optional: true

templates:
  imports: import lora_sdr
  make: lora_sdr.frame_sync(${samp_rate}, ${bandwidth}, ${sf}, ${impl_head}, ${sync_words})

cpp_templates:
  includes: ["#include <lora_sdr/frame_sync.h>"]
  declarations: "lora_sdr::frame_sync::sptr ${id};"
  make: "this->${id} = lora_sdr::frame_sync::make(${samp_rate}, ${bandwidth}, ${sf}, ${impl_head});"
  link: ["gnuradio-lora_sdr"]

documentation: |-
  Block taking care of the preamble detection, CFO and STO estimation and correction.
      Parameters:
          Samp_rate: Sampling rate (should be equal to the bandwidth in the current implementation)
          Bandwidth: Bandwidth
          sf: spreading factor
          impl_head: usage of an implicit header (explicit will be used otherwise)
          num_rscv : Number of Tx signals to receive
      Input:
          in: stream of complex valued sampled
          CR: coding rate
          pay_len: payload length in bytes
          crc: presence of a payload CRC
          err: error in the explicit header
          (optional) frame_err: indicate to save the samples from the last received frame (Need to define GRLORA_DEBUG in cpp code)
      Output:
          out: stream of vectors of 2^sf samples

file_format: 1
